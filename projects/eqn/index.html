<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Charles Matthews | Ensemble Quasi-Newton</title>
<meta name="description" content="The website of Charles Matthews, based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“›</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/projects/eqn/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

  <script src="/assets/js/theme.js"></script>
  <!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       Charles Matthews
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">Ensemble Quasi-Newton</h1>
    <div class="post-description">Scale-invariant, Langevin dynamics-based MCMC
    <div class="row ml-1 mr-1 p-0">
      
      
      <div class="github-icon">
        <div class="icon" data-toggle="tooltip" title="Code Repository">
          <a href="http://bitbucket.org/c%5fmatthews/ensembleqn" style="margin-left:10px;" target="_blank"><i class="fas fa-cloud-download-alt"></i></a>
        </div>
      </div>
      
      
      <div class="github-icon">
        <div class="icon" data-toggle="tooltip" title="Article Link">
          <a href="https://doi.org/10.1007/s11222-017-9730-1" style="margin-left:10px;" target="_blank"> <i class="far fa-file-pdf"></i></a>
        </div>
      </div>
      
    </div>
    </div>
  </header>


  <article>
    <p>In this project we are looking to compute samples \(x\in X\subseteq\mathbb{R}^N\) weighted according to a probability distribution \(\pi(x)\propto\exp(-V(x))\) where the dimension \(N\) is large and \(V\) is sometimes called the <em>potential energy</em> or the <em>negative log posterior</em>. The energy landscape of \(\pi(x)\) can be scaled poorly so that some directions can be explored much slower than others. Consider a valley-like landscape, where if we move too quickly isotropically we will hit a steep incline and be bounced out.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/landscapes2.jpg" alt="" title="" />
    </div>
</div>
<div class="caption">
    Ensemble Quasi-Newton maps the landscape by looking at the covariance of multiple copies of the system. The dynamics are rescaled so that we explore more efficiently by moving in slow directions at an improved rate.
</div>

<p>In a schemes for the conventional over-damped dynamics (such as in Euler-Maruyama integrating Brownian dynamics), we make moves like</p>

\[x_{k+1} \leftarrow x_k + \delta t \nabla \log\pi(x_k) + \sqrt{2 \delta t} R_{k},\]

<p>at iteration \(k\), for a random number \(R_k \sim N(0,I)\). If the timestep \(\delta t&gt;0\) is too large, then we will (proverbially) ping off the edges of the valley and the system will go off to infinity. Ideally, we would like to <em>pre-condition</em> the system, so that moves in the direction perpendicular to the valleyâ€™s edges are made longer and we move more efficiently.</p>

<p>The difficulty lies in figuring out the direction in which to bias the movement. In Newton-iteration schemes the Hessian matrix provides this information, but second derivatives are not always available and expensive to compute at each step. Instead, we approximate the Hessian with the covariance of independent copies of the system.</p>

<p>Consider an <em>ensemble</em> of \(L\) independent walkers, with positions \(Q = (x^{(i)} )_{i=1,\ldots,L}\), and use the update for walker \(i\) as</p>

\[x^{(i)}_{k+1} \leftarrow x^{(i)}_k + B(Q_{[i]})\delta t \nabla \log\pi(x^{(i)}_k) + \sqrt{2 B(Q_{[i]}) \delta t} R^{(i)}_{k},\]

<p>where \(B(Q):=\text{cov}(Q)\) is the Euclidean \(N\times N\) covariance matrix, and \(Q_{[i]}\) is the set of all positions <em>except</em> walker \(i\). This choice removes the divergence term as then \(\nabla_{i} \cdot B(Q_{[i]})\equiv 0\). This choice of $B$ makes the dynamics <em>affine invariant</em> for a large enough (ie \(O(N)\) ) number of walkers \(L\), so the performance will be constant regardless of rescalings of the problem. This is a hugely important feature when we are trying to sample from distributions without physical intuition.</p>

<p>In the article we go into more detail about the convergence results, and demonstrate some numerical experiments showing the power of this formalism. We also show a second-order method with momentum, in the case where barriers stymie progress.</p>

<p>For more details, checkout <a href="https://doi.org/10.1007/s11222-017-9730-1">the article</a> and the <a href="http://bitbucket.org/c%5fmatthews/ensembleqn">Python code</a>.</p>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    &copy; Copyright 2021 Charles  Matthews.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
